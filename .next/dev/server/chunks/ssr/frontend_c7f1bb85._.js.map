{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/components/tables/CanvasTableCard.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef } from 'react';\n\ninterface Slot {\n  nickname?: string;\n  filled?: boolean;\n}\n\ninterface CanvasTableCardProps {\n  tableNumber: number;\n  price: number;\n  cycles: number;\n  slots: [Slot?, Slot?, Slot?, Slot?];\n  isActive: boolean;\n}\n\nexport function CanvasTableCard({ \n  tableNumber, \n  price, \n  cycles, \n  slots,\n  isActive \n}: CanvasTableCardProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const cardRef = useRef<any>(null);\n\n  useEffect(() => {\n    if (!canvasRef.current) return;\n\n    class TonTableCard {\n      canvas: HTMLCanvasElement;\n      ctx: CanvasRenderingContext2D;\n      dpr: number;\n      opts: any;\n      time: number;\n      card: any;\n      animationId?: number;\n\n      constructor(canvas: HTMLCanvasElement, options: any) {\n        this.canvas = canvas;\n        this.ctx = canvas.getContext('2d')!;\n        this.dpr = Math.max(1, window.devicePixelRatio || 1);\n        this.time = 0;\n\n        this.opts = {\n          table: options.table ?? 1,\n          ton: options.ton ?? 10,\n          cyclesClosed: options.cyclesClosed ?? 12,\n          slots: options.slots ?? [null, null, null, null],\n          width: options.width ?? 495,\n          height: options.height ?? 770,\n          animate: options.animate ?? true,\n          isActive: options.isActive ?? true,\n        };\n\n        this.resize(this.opts.width, this.opts.height);\n        \n        if (this.opts.animate) {\n          this.loop = this.loop.bind(this);\n          this.animationId = requestAnimationFrame(this.loop);\n        } else {\n          this.draw(0);\n        }\n      }\n\n      resize(width: number, height: number) {\n        this.opts.width = width;\n        this.opts.height = height;\n\n        this.canvas.width = Math.floor(width * this.dpr);\n        this.canvas.height = Math.floor(height * this.dpr);\n        this.canvas.style.width = `${width}px`;\n        this.canvas.style.height = `${height}px`;\n\n        this.ctx.setTransform(this.dpr, 0, 0, this.dpr, 0, 0);\n        this.draw(0);\n      }\n\n      roundRect(ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number, r: number) {\n        const rr = Math.min(r, w / 2, h / 2);\n        ctx.beginPath();\n        ctx.moveTo(x + rr, y);\n        ctx.arcTo(x + w, y, x + w, y + h, rr);\n        ctx.arcTo(x + w, y + h, x, y + h, rr);\n        ctx.arcTo(x, y + h, x, y, rr);\n        ctx.arcTo(x, y, x + w, y, rr);\n        ctx.closePath();\n      }\n\n      getAnimatedGradient(ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number, t: number) {\n        const phase = (t * 0.001) % 1;\n        \n        const colors = [\n          { r: 59, g: 130, b: 246 },\n          { r: 139, g: 92, b: 246 },\n          { r: 236, g: 72, b: 153 },\n          { r: 59, g: 130, b: 246 },\n        ];\n\n        const grad = ctx.createLinearGradient(x, y, x + w, y + h);\n        \n        for (let i = 0; i < 3; i++) {\n          const pos = (i / 2 + phase) % 1;\n          const idx = Math.floor(pos * 3);\n          const nextIdx = (idx + 1) % 3;\n          const localPhase = (pos * 3) % 1;\n          \n          const c1 = colors[idx];\n          const c2 = colors[nextIdx];\n          \n          const r = Math.round(c1.r + (c2.r - c1.r) * localPhase);\n          const g = Math.round(c1.g + (c2.g - c1.g) * localPhase);\n          const b = Math.round(c1.b + (c2.b - c1.b) * localPhase);\n          \n          grad.addColorStop(i / 2, `rgba(${r}, ${g}, ${b}, 0.9)`);\n        }\n        \n        return grad;\n      }\n\n      drawDiamondIcon(ctx: CanvasRenderingContext2D, x: number, y: number, s: number) {\n        ctx.save();\n        ctx.translate(x, y);\n        ctx.strokeStyle = this.opts.isActive ? 'rgba(160, 235, 255, 0.95)' : 'rgba(100, 100, 120, 0.5)';\n        ctx.lineWidth = 2;\n\n        const w = s;\n        const h = s * 0.72;\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.lineTo(w * 0.22, -h * 0.35);\n        ctx.lineTo(w * 0.78, -h * 0.35);\n        ctx.lineTo(w, 0);\n        ctx.lineTo(w * 0.5, h);\n        ctx.closePath();\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(w * 0.22, -h * 0.35);\n        ctx.lineTo(w * 0.5, 0);\n        ctx.lineTo(w * 0.78, -h * 0.35);\n        ctx.moveTo(w * 0.22, -h * 0.35);\n        ctx.lineTo(w * 0.35, 0);\n        ctx.lineTo(w * 0.5, h);\n        ctx.moveTo(w * 0.78, -h * 0.35);\n        ctx.lineTo(w * 0.65, 0);\n        ctx.lineTo(w * 0.5, h);\n        ctx.stroke();\n\n        if (this.opts.isActive) {\n          ctx.shadowColor = 'rgba(120,220,255,0.9)';\n          ctx.shadowBlur = 18;\n          ctx.stroke();\n        }\n        ctx.restore();\n      }\n\n      drawPlatforms(t: number) {\n        const ctx = this.ctx;\n        const W = this.opts.width;\n        const H = this.opts.height;\n        \n        if (!this.opts.isActive) return;\n\n        const cx = W / 2;\n        const baseY = H * 0.88;\n        const baseW = W * 0.72;\n        const baseH = H * 0.045;\n\n        const layers = [\n          { scale: 1.08, yOff: 18, alpha: 0.25 },\n          { scale: 1.00, yOff: 9, alpha: 0.35 },\n          { scale: 0.92, yOff: 0, alpha: 0.45 },\n        ];\n\n        layers.forEach((L, idx) => {\n          const lw = baseW * L.scale;\n          const lh = baseH;\n          const x = cx - lw / 2;\n          const y = baseY + L.yOff;\n\n          const g = ctx.createLinearGradient(x, y, x + lw, y + lh);\n          g.addColorStop(0, `rgba(30, 60, 160, ${L.alpha})`);\n          g.addColorStop(0.5, `rgba(60, 40, 180, ${L.alpha})`);\n          g.addColorStop(1, `rgba(120, 40, 200, ${L.alpha})`);\n          ctx.fillStyle = g;\n          this.roundRect(ctx, x, y, lw, lh, 12);\n          ctx.fill();\n\n          const pulse = 0.6 + 0.4 * Math.sin(t * 0.003 + idx * 0.8);\n          ctx.strokeStyle = this.getAnimatedGradient(ctx, x, y, lw, lh, t);\n          ctx.globalAlpha = pulse * 0.7;\n          ctx.lineWidth = 2;\n          this.roundRect(ctx, x, y, lw, lh, 12);\n          ctx.stroke();\n          ctx.globalAlpha = 1;\n        });\n      }\n\n      drawCardShell(t: number) {\n        const ctx = this.ctx;\n        const W = this.opts.width;\n        const H = this.opts.height;\n\n        const pad = Math.round(W * 0.08);\n        const x = pad;\n        const y = Math.round(H * 0.06);\n        const w = W - pad * 2;\n        const h = H - Math.round(H * 0.20);\n\n        this.card = { x, y, w, h };\n\n        ctx.clearRect(0, 0, W, H);\n\n        this.drawPlatforms(t);\n\n        if (this.opts.isActive) {\n          ctx.save();\n          ctx.shadowColor = 'rgba(113, 83, 255, 0.6)';\n          ctx.shadowBlur = 30;\n          this.roundRect(ctx, x, y, w, h, 42);\n          ctx.strokeStyle = 'rgba(130,120,255,0.25)';\n          ctx.lineWidth = 1;\n          ctx.stroke();\n          ctx.restore();\n        }\n\n        const fill = ctx.createLinearGradient(x, y, x + w, y + h);\n        if (this.opts.isActive) {\n          fill.addColorStop(0, 'rgba(7, 18, 70, 0.82)');\n          fill.addColorStop(0.55, 'rgba(8, 22, 88, 0.78)');\n          fill.addColorStop(1, 'rgba(28, 12, 88, 0.78)');\n        } else {\n          fill.addColorStop(0, 'rgba(20, 20, 30, 0.6)');\n          fill.addColorStop(1, 'rgba(30, 30, 40, 0.6)');\n        }\n        ctx.fillStyle = fill;\n        this.roundRect(ctx, x, y, w, h, 42);\n        ctx.fill();\n\n        if (this.opts.isActive) {\n          const pulse = 0.7 + 0.3 * Math.sin(t * 0.002);\n          ctx.strokeStyle = this.getAnimatedGradient(ctx, x, y, w, h, t);\n          ctx.globalAlpha = pulse;\n          ctx.lineWidth = 3;\n          this.roundRect(ctx, x, y, w, h, 42);\n          ctx.stroke();\n          ctx.globalAlpha = 1;\n\n          ctx.shadowColor = 'rgba(139, 92, 246, 0.8)';\n          ctx.shadowBlur = 40;\n          ctx.lineWidth = 2;\n          this.roundRect(ctx, x, y, w, h, 42);\n          ctx.stroke();\n          ctx.shadowBlur = 0;\n        }\n\n        if (this.opts.isActive) {\n          const dustY = y + h * 0.70;\n          for (let i = 0; i < 50; i++) {\n            const px = x + 12 + ((i * 37.17) % (w - 24));\n            const py = dustY + ((i * 53.91 + (t * 0.02)) % (h - (dustY - y) - 12));\n            const a = 0.15 + ((i * 0.07) % 0.3);\n            ctx.fillStyle = i % 3 === 0 ? `rgba(90,220,255,${a})` : `rgba(200,120,255,${a})`;\n            ctx.beginPath();\n            ctx.arc(px, py, (i % 5) * 0.18 + 0.6, 0, Math.PI * 2);\n            ctx.fill();\n          }\n        }\n      }\n\n      drawHeader() {\n        const ctx = this.ctx;\n        const { x, y, w } = this.card;\n\n        const iconX = x + w * 0.09;\n        const iconY = y + 45;\n        this.drawDiamondIcon(ctx, iconX, iconY, 40);\n\n        ctx.font = '700 38px Inter, system-ui, Arial, sans-serif';\n        ctx.fillStyle = this.opts.isActive ? 'rgba(240,248,255,0.95)' : 'rgba(160,160,170,0.7)';\n        ctx.textBaseline = 'middle';\n        ctx.fillText(`Table ${this.opts.table}`, x + w * 0.35, y + 45);\n      }\n\n      drawSlots() {\n        const ctx = this.ctx;\n        const { x, y, w } = this.card;\n\n        const topY = y + 100;\n        const slotW = (w - 60) / 2;\n        const slotH = 80;\n        const gap = 15;\n\n        const slotPositions = [\n          { x: x + 20, y: topY },\n          { x: x + 20 + slotW + gap, y: topY },\n          { x: x + 20, y: topY + slotH + 12 },\n          { x: x + 20 + slotW + gap, y: topY + slotH + 12 },\n        ];\n\n        ctx.font = '600 18px Inter, system-ui, Arial, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.textBaseline = 'middle';\n\n        slotPositions.forEach((s, i) => {\n          const slot = this.opts.slots[i];\n          const filled = slot?.nickname || slot?.filled;\n\n          const fill = ctx.createLinearGradient(s.x, s.y, s.x + slotW, s.y + slotH);\n          if (filled && this.opts.isActive) {\n            fill.addColorStop(0, 'rgba(34, 197, 94, 0.35)');\n            fill.addColorStop(1, 'rgba(59, 130, 246, 0.35)');\n          } else {\n            fill.addColorStop(0, 'rgba(34, 53, 130, 0.35)');\n            fill.addColorStop(1, 'rgba(40, 28, 125, 0.25)');\n          }\n\n          ctx.fillStyle = fill;\n          this.roundRect(ctx, s.x, s.y, slotW, slotH, 16);\n          ctx.fill();\n\n          if (filled && this.opts.isActive) {\n            const pulse = 0.6 + 0.4 * Math.sin(this.time * 0.003 + i * 0.5);\n            ctx.strokeStyle = this.getAnimatedGradient(ctx, s.x, s.y, slotW, slotH, this.time + i * 500);\n            ctx.globalAlpha = pulse;\n            ctx.lineWidth = 2.5;\n            this.roundRect(ctx, s.x, s.y, slotW, slotH, 16);\n            ctx.stroke();\n            ctx.globalAlpha = 1;\n\n            ctx.shadowColor = 'rgba(34, 197, 94, 0.6)';\n            ctx.shadowBlur = 15;\n            ctx.lineWidth = 1.5;\n            this.roundRect(ctx, s.x, s.y, slotW, slotH, 16);\n            ctx.stroke();\n            ctx.shadowBlur = 0;\n          } else if (!filled || !this.opts.isActive) {\n            ctx.strokeStyle = this.opts.isActive ? 'rgba(89,223,255,0.4)' : 'rgba(60,60,70,0.3)';\n            ctx.lineWidth = 1.5;\n            this.roundRect(ctx, s.x, s.y, slotW, slotH, 16);\n            ctx.stroke();\n          }\n\n          if (slot?.nickname) {\n            ctx.fillStyle = this.opts.isActive ? 'rgba(230,245,255,0.95)' : 'rgba(160,160,170,0.7)';\n            ctx.fillText(slot.nickname, s.x + slotW / 2, s.y + slotH / 2);\n          } else if (!filled) {\n            ctx.fillStyle = 'rgba(120,120,130,0.5)';\n            ctx.fillText('Empty', s.x + slotW / 2, s.y + slotH / 2);\n          }\n        });\n\n        ctx.textAlign = 'left';\n      }\n\n      drawTonBar() {\n        const ctx = this.ctx;\n        const { x, y, w } = this.card;\n\n        const barX = x + 20;\n        const barY = y + 295;\n        const barW = w - 40;\n        const barH = 70;\n\n        const g = ctx.createLinearGradient(barX, barY, barX + barW, barY);\n        if (this.opts.isActive) {\n          g.addColorStop(0, 'rgba(17,33,125,0.85)');\n          g.addColorStop(0.5, 'rgba(18,46,165,0.8)');\n          g.addColorStop(1, 'rgba(97,41,163,0.85)');\n        } else {\n          g.addColorStop(0, 'rgba(40,40,50,0.6)');\n          g.addColorStop(1, 'rgba(50,50,60,0.6)');\n        }\n        ctx.fillStyle = g;\n        this.roundRect(ctx, barX, barY, barW, barH, 16);\n        ctx.fill();\n\n        if (this.opts.isActive) {\n          const pulse = 0.7 + 0.3 * Math.sin(this.time * 0.0025);\n          ctx.strokeStyle = this.getAnimatedGradient(ctx, barX, barY, barW, barH, this.time);\n          ctx.globalAlpha = pulse;\n          ctx.lineWidth = 2.5;\n          this.roundRect(ctx, barX, barY, barW, barH, 16);\n          ctx.stroke();\n          ctx.globalAlpha = 1;\n        }\n\n        ctx.font = '700 42px Inter, system-ui, Arial, sans-serif';\n        ctx.fillStyle = this.opts.isActive ? 'rgba(235,245,255,0.98)' : 'rgba(160,160,170,0.7)';\n        ctx.textAlign = 'center';\n        ctx.textBaseline = 'middle';\n        ctx.fillText(`${this.opts.ton} TON`, barX + barW / 2, barY + barH / 2);\n        ctx.textAlign = 'left';\n      }\n\n      drawCycles() {\n        const ctx = this.ctx;\n        const { x, y, w } = this.card;\n\n        ctx.font = '500 28px Inter, system-ui, Arial, sans-serif';\n        ctx.fillStyle = this.opts.isActive ? 'rgba(234,244,255,0.95)' : 'rgba(160,160,170,0.7)';\n        ctx.textAlign = 'center';\n        ctx.textBaseline = 'middle';\n        ctx.fillText(`Cycles closed: ${this.opts.cyclesClosed}`, x + w / 2, y + 400);\n        ctx.textAlign = 'left';\n      }\n\n      draw(timeMs: number) {\n        this.time = timeMs;\n        this.drawCardShell(timeMs);\n        this.drawHeader();\n        this.drawSlots();\n        this.drawTonBar();\n        this.drawCycles();\n      }\n\n      loop(ts: number) {\n        this.draw(ts);\n        this.animationId = requestAnimationFrame(this.loop.bind(this));\n      }\n\n      destroy() {\n        if (this.animationId) {\n          cancelAnimationFrame(this.animationId);\n        }\n      }\n    }\n\n    const slotsData = slots.map(slot => ({\n      nickname: slot?.nickname,\n      filled: slot?.filled || !!slot?.nickname\n    }));\n\n    cardRef.current = new TonTableCard(canvasRef.current, {\n      table: tableNumber,\n      ton: price,\n      cyclesClosed: cycles,\n      slots: slotsData,\n      animate: true,\n      width: 495,\n      height: 770,\n      isActive: isActive\n    });\n\n    return () => {\n      cardRef.current?.destroy();\n    };\n  }, [tableNumber, price, cycles, slots, isActive]);\n\n  return <canvas ref={canvasRef} className=\"w-full h-auto\" />;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 443, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/components/ScrollButtons.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { X, Table, Users, TrendingUp, Settings, Sun, Moon } from 'lucide-react';\nimport { AnimatedBackground } from '@/components/layout/AnimatedBackground';\n\nexport function ScrollButtons() {\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const [isDark, setIsDark] = useState(true);\n  const [userStats, setUserStats] = useState({\n    totalEarned: 0,\n    activeTables: 0,\n    directReferrals: 0, // Personal workers\n    totalReferrals: 0,  // Entire tree\n    totalCycles: 0\n  });\n  const [referralsList, setReferralsList] = useState<any[]>([]);\n  const [upline, setUpline] = useState<any>(null);\n\n  useEffect(() => {\n    const fetchUserStats = async () => {\n      const userId = localStorage.getItem('matrix_ton_user_id') || '1';\n      \n      // Fetch tables\n      const tablesRes = await fetch(`/api/user/tables?userId=${userId}`);\n      const tablesData = await tablesRes.json();\n      \n      if (tablesData.success) {\n        const activeTables = tablesData.tables.filter((t: any) => t.status === 'ACTIVE').length;\n        const totalCycles = tablesData.tables.reduce((sum: number, t: any) => sum + t.cycleNumber, 0);\n        \n        setUserStats(prev => ({\n          ...prev,\n          totalEarned: 0, // TODO: calculate from transactions\n          activeTables,\n          totalCycles\n        }));\n      }\n\n      // Fetch referrals\n      const referralsRes = await fetch(`/api/user/referrals?userId=${userId}`);\n      const referralsData = await referralsRes.json();\n\n      if (referralsData.success) {\n        setUserStats(prev => ({\n          ...prev,\n          directReferrals: referralsData.directCount,\n          totalReferrals: referralsData.totalTreeCount\n        }));\n        \n        // Save first 3 referrals for display\n        setReferralsList(referralsData.directReferrals.slice(0, 3));\n        setUpline(referralsData.upline); // Save upline\n      }\n    };\n    \n    if (isMenuOpen) {\n      fetchUserStats();\n    }\n  }, [isMenuOpen]);\n\n  const toggleTheme = () => {\n    setIsDark(!isDark);\n    document.documentElement.classList.toggle('light-theme');\n  };\n\n  return (\n    <>\n      {/* Theme Button - TOP LEFT */}\n      <div style={{ \n        position: 'fixed', \n        top: '24px', \n        left: '24px',\n        zIndex: 99999,\n        width: '128px',\n        height: '128px'\n      }}>\n        <button\n          onClick={toggleTheme}\n          style={{\n            width: '128px',\n            height: '128px',\n            borderRadius: '50%',\n            background: 'rgba(139, 92, 246, 0.2)',\n            backdropFilter: 'blur(10px)',\n            border: '1px solid rgba(139, 92, 246, 0.4)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            cursor: 'pointer',\n            transition: 'all 0.3s'\n          }}\n        >\n          {isDark ? <Sun size={48} className=\"text-purple-300\" /> : <Moon size={48} className=\"text-purple-300\" />}\n        </button>\n      </div>\n\n      {/* Menu Button - TOP RIGHT */}\n      <div \n        style={{ \n          position: 'fixed', \n          top: '24px', \n          right: '24px', \n          zIndex: 99999,\n          width: '128px',\n          height: '128px'\n        }}\n      >\n        <button\n          onClick={() => setIsMenuOpen(!isMenuOpen)}\n          style={{\n            width: '100%',\n            height: '100%',\n            borderRadius: '50%',\n            background: 'rgba(30, 30, 50, 0.3)',\n            backdropFilter: 'blur(10px)',\n            border: '1px solid rgba(139, 92, 246, 0.5)',\n            boxShadow: '0 8px 32px rgba(139, 92, 246, 0.3)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            cursor: 'pointer',\n            transition: 'all 0.3s'\n          }}\n        >\n          {isMenuOpen ? (\n            <X size={48} className=\"text-purple-300\" />\n          ) : (\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '12px', alignItems: 'center' }}>\n              <div \n                style={{ \n                  width: '56px',\n                  height: '6px',\n                  background: 'rgba(168, 85, 247, 0.9)',\n                  borderRadius: '10px'\n                }}\n              />\n              <div \n                style={{ \n                  width: '56px',\n                  height: '6px',\n                  background: 'rgba(168, 85, 247, 0.9)',\n                  borderRadius: '10px'\n                }}\n              />\n              <div \n                style={{ \n                  width: '56px',\n                  height: '6px',\n                  background: 'rgba(168, 85, 247, 0.9)',\n                  borderRadius: '10px'\n                }}\n              />\n            </div>\n          )}\n        </button>\n      </div>\n\n      {/* Side Menu Panel */}\n      {isMenuOpen && (\n        <>\n          <div \n            style={{ \n              position: 'fixed',\n              inset: 0,\n              backgroundColor: 'rgba(0, 0, 0, 0.7)',\n              zIndex: 99998\n            }}\n          />\n          <div \n            style={{ \n              position: 'fixed',\n              top: 0,\n              right: 0,\n              height: '100%',\n              width: '100%',\n              zIndex: 99999,\n              background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)',\n              overflowY: 'auto',\n              color: '#ffffff',\n              paddingTop: '120px',\n              lineHeight: '1.8'\n            }}\n            className=\"p-12 menu-text\"\n          >\n            <AnimatedBackground />\n            <div className=\"flex flex-col h-full relative z-10\">\n              {/* Header */}\n              <div className=\"relative mb-20\">\n                <div>\n                  <p className=\"text-purple-300\" style={{ fontSize: '4.5rem' }}>@CryptoKing</p>\n                </div>\n                \n                {/* Close button - matches menu button style exactly */}\n                <button\n                  onClick={() => setIsMenuOpen(false)}\n                  style={{\n                    position: 'fixed',\n                    top: '24px',\n                    right: '24px',\n                    width: '128px',\n                    height: '128px',\n                    borderRadius: '50%',\n                    background: 'rgba(139, 92, 246, 0.2)',\n                    backdropFilter: 'blur(10px)',\n                    border: '1px solid rgba(139, 92, 246, 0.4)',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s',\n                    zIndex: 100000\n                  }}\n                >\n                  <X size={48} className=\"text-purple-300\" />\n                </button>\n              </div>\n\n              {/* Stats Grid */}\n              <div className=\"flex flex-col gap-12 mb-20\">\n                <div className=\"p-10 rounded-2xl bg-gradient-to-br from-purple-600/20 to-pink-600/20 min-h-[200px]\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"text-white\" style={{ fontSize: '3.75rem' }}>Total Earned</div>\n                    <div className=\"text-white font-bold\" style={{ fontSize: '6rem' }}>{userStats.totalEarned} TON</div>\n                  </div>\n                </div>\n                \n                <div className=\"p-10 rounded-2xl bg-gradient-to-br from-cyan-600/20 to-blue-600/20 min-h-[200px]\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"text-white\" style={{ fontSize: '3.75rem' }}>Active Tables</div>\n                    <div className=\"text-white font-bold\" style={{ fontSize: '6rem' }}>{userStats.activeTables}/12</div>\n                  </div>\n                </div>\n                \n                <div className=\"p-10 rounded-2xl bg-gradient-to-br from-pink-600/20 to-red-600/20 min-h-[200px]\">\n                  <div className=\"flex flex-col gap-4\">\n                    <div className=\"text-white\" style={{ fontSize: '3.75rem' }}>Referrals</div>\n                    \n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"text-gray-400\" style={{ fontSize: '2.5rem' }}>Direct</div>\n                      <div className=\"text-white font-bold\" style={{ fontSize: '3rem' }}>{userStats.directReferrals}</div>\n                    </div>\n                    \n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"text-gray-400\" style={{ fontSize: '2.5rem' }}>Total Tree</div>\n                      <div className=\"text-white font-bold\" style={{ fontSize: '3rem' }}>{userStats.totalReferrals}</div>\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"p-10 rounded-2xl bg-gradient-to-br from-green-600/20 to-emerald-600/20 min-h-[200px]\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"text-white\" style={{ fontSize: '3.75rem' }}>Total Cycles</div>\n                    <div className=\"text-white font-bold\" style={{ fontSize: '6rem' }}>{userStats.totalCycles}</div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Referral Tree */}\n              <div className=\"flex-1 overflow-y-auto\" style={{ marginTop: '80px' }}>\n                <h3 className=\"font-bold text-white mb-10\" style={{ fontSize: '6rem' }}>\n                  My Referral Tree\n                </h3>\n                \n                {/* Upline - only show if exists (not MASTER's referral) */}\n                {upline && (\n                  <div className=\"mb-16\">\n                    <div className=\"mb-10\" style={{ fontSize: '2.25rem', color: '#a78bfa' }}>\n                      â†‘ Referred by\n                    </div>\n                    <div className=\"p-10 rounded-2xl bg-purple-600/20\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <div className=\"font-bold text-white\" style={{ fontSize: '3rem' }}>\n                            @{upline.nickname}\n                          </div>\n                          <div className=\"text-gray-400\" style={{ fontSize: '2rem', marginTop: '8px' }}>\n                            {upline.activeTables} tables â€¢ {upline.referralsCount} referrals\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Your direct referrals */}\n                <div>\n                  <div className=\"mb-10\" style={{ fontSize: '2.25rem', color: '#22d3ee' }}>\n                    â†“ My Direct Referrals ({userStats.directReferrals})\n                  </div>\n                  <div className=\"space-y-8\">\n                    {referralsList.length > 0 ? (\n                      referralsList.map((ref) => (\n                        <div key={ref.id} className=\"p-10 rounded-2xl bg-cyan-600/10\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <div className=\"font-bold text-white\" style={{ fontSize: '3rem' }}>\n                                @{ref.nickname}\n                              </div>\n                              <div className=\"text-gray-400\" style={{ fontSize: '2rem', marginTop: '8px' }}>\n                                {ref.activeTables} tables â€¢ {ref.referralsCount} referrals\n                              </div>\n                              <div className=\"text-green-400 font-bold\" style={{ fontSize: '2.5rem', marginTop: '8px' }}>\n                                ðŸ’° {ref.totalEarnings || 0} TON\n                              </div>\n                            </div>\n                            <div className=\"text-green-400\" style={{ fontSize: '2rem' }}>Active</div>\n                          </div>\n                        </div>\n                      ))\n                    ) : (\n                      <div className=\"p-10 rounded-2xl bg-white/5 text-center\">\n                        <div className=\"text-gray-400\" style={{ fontSize: '2.5rem' }}>No direct referrals yet</div>\n                      </div>\n                    )}\n\n                    {userStats.directReferrals > 3 && (\n                      <div className=\"p-10 rounded-2xl bg-white/5 text-center\">\n                        <div className=\"text-gray-400\" style={{ fontSize: '2.5rem' }}>\n                          + {userStats.directReferrals - 3} more referrals\n                        </div>\n                        <button \n                          onClick={() => window.location.href = '/referrals'}\n                          className=\"text-purple-400 hover:underline\"\n                          style={{ fontSize: '2rem', marginTop: '8px' }}\n                        >\n                          View All â†’\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1254, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/lib/types.ts"],"sourcesContent":["export interface Table {\n  id: number;\n  userId: number;\n  tableNumber: number;\n  status: 'ACTIVE' | 'CLOSED';\n  cycleNumber: number;\n  createdAt: string;\n  closedAt: string | null;\n  positions: TablePosition[];\n}\n\nexport interface TablePosition {\n  id: number;\n  tableId: number;\n  partnerUserId: number;\n  partnerNickname?: string;\n  position: number;\n  cycleNumber: number;\n  amountPaid: number;\n  amountReceived: number;\n  status: 'PAID_OUT' | 'PENDING_PAYOUT' | 'HELD_FOR_AUTOPURCHASE' | 'PLATFORM_INCOME';\n  txHash?: string;\n  processedAt?: string;\n  createdAt: string;\n}\n\nexport const TABLE_PRICES: Record<number, number> = {\n  1: 10,\n  2: 20,\n  3: 40,\n  4: 80,\n  5: 160,\n  6: 320,\n  7: 640,\n  8: 1280,\n  9: 2560,\n  10: 5120,\n  11: 10240,\n  12: 20480,\n};\n"],"names":[],"mappings":";;;;AA0BO,MAAM,eAAuC;IAClD,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,GAAG;IACH,IAAI;IACJ,IAAI;IACJ,IAAI;AACN"}},
    {"offset": {"line": 1276, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/components/ton/WalletConnectButton.tsx"],"sourcesContent":["'use client';\n\nimport { TonConnectButton, useTonAddress, useTonConnectUI } from '@tonconnect/ui-react';\nimport { useEffect, useState } from 'react';\n\nexport function WalletConnectButton() {\n  const address = useTonAddress();\n  const [tonConnectUI] = useTonConnectUI();\n  const [balance, setBalance] = useState<string>('0');\n\n  useEffect(() => {\n    if (address) {\n      // Fetch balance from blockchain\n      fetchBalance(address);\n    }\n  }, [address]);\n\n  const fetchBalance = async (addr: string) => {\n    try {\n      const response = await fetch(`https://tonapi.io/v2/accounts/${addr}`);\n      const data = await response.json();\n      const balanceNano = data.balance;\n      const balanceTON = (parseInt(balanceNano) / 1e9).toFixed(2);\n      setBalance(balanceTON);\n    } catch (error) {\n      console.error('Error fetching balance:', error);\n    }\n  };\n\n  if (!address) {\n    return (\n      <div className=\"flex flex-col items-center gap-4\">\n        <TonConnectButton />\n        <p className=\"text-gray-400 text-sm\">Connect wallet to activate tables</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col items-center gap-4 p-6 rounded-2xl bg-gradient-to-br from-blue-600/20 to-purple-600/20\">\n      <div className=\"flex items-center gap-3\">\n        <div className=\"w-3 h-3 rounded-full bg-green-400 animate-pulse\" />\n        <span className=\"text-white font-bold text-xl\">Wallet Connected</span>\n      </div>\n      \n      <div className=\"text-center\">\n        <div className=\"text-gray-400 text-sm mb-1\">Address</div>\n        <div className=\"text-white font-mono text-sm\">\n          {address.slice(0, 8)}...{address.slice(-8)}\n        </div>\n      </div>\n\n      <div className=\"text-center\">\n        <div className=\"text-gray-400 text-sm mb-1\">Balance</div>\n        <div className=\"text-white font-bold text-3xl\">{balance} TON</div>\n      </div>\n\n      <button\n        onClick={() => tonConnectUI.disconnect()}\n        className=\"px-6 py-3 rounded-xl bg-red-500/20 hover:bg-red-500/30 text-red-400 font-bold transition-all\"\n      >\n        Disconnect\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKO,SAAS;IACd,MAAM,UAAU,IAAA,yMAAa;IAC7B,MAAM,CAAC,aAAa,GAAG,IAAA,2MAAe;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAS;IAE/C,IAAA,8NAAS,EAAC;QACR,IAAI,SAAS;YACX,gCAAgC;YAChC,aAAa;QACf;IACF,GAAG;QAAC;KAAQ;IAEZ,MAAM,eAAe,OAAO;QAC1B,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,CAAC,8BAA8B,EAAE,MAAM;YACpE,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,MAAM,cAAc,KAAK,OAAO;YAChC,MAAM,aAAa,CAAC,SAAS,eAAe,GAAG,EAAE,OAAO,CAAC;YACzD,WAAW;QACb,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C;IACF;IAEA,IAAI,CAAC,SAAS;QACZ,qBACE,0PAAC;YAAI,WAAU;;8BACb,0PAAC,4MAAgB;;;;;8BACjB,0PAAC;oBAAE,WAAU;8BAAwB;;;;;;;;;;;;IAG3C;IAEA,qBACE,0PAAC;QAAI,WAAU;;0BACb,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAI,WAAU;;;;;;kCACf,0PAAC;wBAAK,WAAU;kCAA+B;;;;;;;;;;;;0BAGjD,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,0PAAC;wBAAI,WAAU;;4BACZ,QAAQ,KAAK,CAAC,GAAG;4BAAG;4BAAI,QAAQ,KAAK,CAAC,CAAC;;;;;;;;;;;;;0BAI5C,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,0PAAC;wBAAI,WAAU;;4BAAiC;4BAAQ;;;;;;;;;;;;;0BAG1D,0PAAC;gBACC,SAAS,IAAM,aAAa,UAAU;gBACtC,WAAU;0BACX;;;;;;;;;;;;AAKP"}},
    {"offset": {"line": 1438, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/lib/wallets.ts"],"sourcesContent":["// Platform wallets configuration\n\nexport const PLATFORM_WALLETS = {\n  // INCOME WALLET - Pure profit\n  INCOME: {\n    address: process.env.NEXT_PUBLIC_INCOME_WALLET!,\n    purpose: 'Platform income',\n    receives: [\n      '100% of Table 1 payments',\n      '10% commission from Table 2-12 payments'\n    ]\n  },\n  \n  // OPERATIONS WALLET - System operations\n  OPERATIONS: {\n    address: process.env.NEXT_PUBLIC_OPERATIONS_WALLET!,\n    purpose: 'System operations',\n    receives: [\n      '90% of Table 2-12 payments (after 10% commission)'\n    ],\n    handles: [\n      'User payouts (slot 1)',\n      'Holding funds (slots 2-3) for auto-purchase',\n      'Table reactivation (slot 4)',\n      'Spillover operations'\n    ]\n  }\n};\n\n// Payment routing logic\nexport function getPaymentDestination(tableNumber: number): string {\n  if (tableNumber === 1) {\n    // Table 1: 100% to INCOME wallet\n    return PLATFORM_WALLETS.INCOME.address;\n  } else {\n    // Table 2-12: Payment goes to OPERATIONS wallet\n    // Backend will split: 10% to INCOME, 90% stays in OPERATIONS\n    return PLATFORM_WALLETS.OPERATIONS.address;\n  }\n}\n\n// Calculate payment split\nexport function calculatePaymentSplit(tableNumber: number, amount: number) {\n  if (tableNumber === 1) {\n    return {\n      toIncome: amount,      // 100%\n      toOperations: 0,       // 0%\n      commission: amount     // All is commission\n    };\n  } else {\n    const commission = amount * 0.10;\n    const operations = amount * 0.90;\n    \n    return {\n      toIncome: commission,     // 10%\n      toOperations: operations, // 90%\n      commission: commission\n    };\n  }\n}\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;;;;;;AAE1B,MAAM,mBAAmB;IAC9B,8BAA8B;IAC9B,QAAQ;QACN,OAAO;QACP,SAAS;QACT,UAAU;YACR;YACA;SACD;IACH;IAEA,wCAAwC;IACxC,YAAY;QACV,OAAO;QACP,SAAS;QACT,UAAU;YACR;SACD;QACD,SAAS;YACP;YACA;YACA;YACA;SACD;IACH;AACF;AAGO,SAAS,sBAAsB,WAAmB;IACvD,IAAI,gBAAgB,GAAG;QACrB,iCAAiC;QACjC,OAAO,iBAAiB,MAAM,CAAC,OAAO;IACxC,OAAO;QACL,gDAAgD;QAChD,6DAA6D;QAC7D,OAAO,iBAAiB,UAAU,CAAC,OAAO;IAC5C;AACF;AAGO,SAAS,sBAAsB,WAAmB,EAAE,MAAc;IACvE,IAAI,gBAAgB,GAAG;QACrB,OAAO;YACL,UAAU;YACV,cAAc;YACd,YAAY,OAAW,oBAAoB;QAC7C;IACF,OAAO;QACL,MAAM,aAAa,SAAS;QAC5B,MAAM,aAAa,SAAS;QAE5B,OAAO;YACL,UAAU;YACV,cAAc;YACd,YAAY;QACd;IACF;AACF"}},
    {"offset": {"line": 1503, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/components/ton/TablePurchaseButton.tsx"],"sourcesContent":["'use client';\n\nimport { useTonAddress, useTonConnectUI } from '@tonconnect/ui-react';\nimport { beginCell, toNano } from '@ton/core';\nimport { useState } from 'react';\nimport { getPaymentDestination } from '@/lib/wallets';\n\ninterface TablePurchaseButtonProps {\n  tableNumber: number;\n  price: number;\n  isActive: boolean;\n  isPurchasing?: boolean;\n}\n\nexport function TablePurchaseButton({ \n  tableNumber, \n  price, \n  isActive,\n  isPurchasing = false \n}: TablePurchaseButtonProps) {\n  const address = useTonAddress();\n  const [tonConnectUI] = useTonConnectUI();\n  const [loading, setLoading] = useState(false);\n\n  const handlePurchase = async () => {\n    if (!address) {\n      alert('Please connect your wallet first');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const userId = localStorage.getItem('matrix_ton_user_id') || '1';\n      \n      // Payment recipient (platform wallet) - uses two-wallet system\n      const recipientAddress = getPaymentDestination(tableNumber);\n\n      // Create comment for transaction\n      const comment = `table_${tableNumber}_${userId}_${Date.now()}`;\n      const commentCell = beginCell()\n        .storeUint(0, 32)\n        .storeStringTail(comment)\n        .endCell();\n\n      // Send transaction\n      const transaction = {\n        validUntil: Math.floor(Date.now() / 1000) + 600, // 10 minutes\n        messages: [\n          {\n            address: recipientAddress,\n            amount: toNano(price).toString(),\n            payload: commentCell.toBoc().toString('base64')\n          }\n        ]\n      };\n\n      const result = await tonConnectUI.sendTransaction(transaction);\n      \n      if (result) {\n        console.log('Transaction sent:', result);\n        \n        // Notify backend about the transaction\n        try {\n          const processResponse = await fetch('/api/payments/process', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n              txHash: result.boc,\n              userId,\n              tableNumber,\n              amount: price,\n              fromAddress: address,\n              toAddress: recipientAddress\n            })\n          });\n          \n          const processData = await processResponse.json();\n          \n          if (processData.success) {\n            alert(`Table ${tableNumber} purchased successfully!`);\n            window.location.reload();\n          } else {\n            alert(`Transaction sent but processing failed: ${processData.error}`);\n          }\n        } catch (processError) {\n          console.error('Payment processing error:', processError);\n          alert('Transaction sent! Processing will happen automatically.');\n          window.location.reload();\n        }\n      }\n    } catch (error) {\n      console.error('Purchase error:', error);\n      alert('Purchase failed. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (isActive) {\n    return (\n      <button\n        disabled\n        className=\"w-full py-4 rounded-xl bg-green-600/20 text-green-400 font-bold text-xl cursor-not-allowed\"\n      >\n        âœ“ Active\n      </button>\n    );\n  }\n\n  if (!address) {\n    return (\n      <button\n        disabled\n        className=\"w-full py-4 rounded-xl bg-gray-600/20 text-gray-400 font-bold text-xl cursor-not-allowed\"\n      >\n        Connect Wallet First\n      </button>\n    );\n  }\n\n  return (\n    <button\n      onClick={handlePurchase}\n      disabled={loading || isPurchasing}\n      className=\"w-full py-4 rounded-xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white font-bold text-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n    >\n      {loading ? 'Processing...' : `Buy for ${price} TON`}\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAcO,SAAS,oBAAoB,EAClC,WAAW,EACX,KAAK,EACL,QAAQ,EACR,eAAe,KAAK,EACK;IACzB,MAAM,UAAU,IAAA,yMAAa;IAC7B,MAAM,CAAC,aAAa,GAAG,IAAA,2MAAe;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IAEvC,MAAM,iBAAiB;QACrB,IAAI,CAAC,SAAS;YACZ,MAAM;YACN;QACF;QAEA,WAAW;QAEX,IAAI;YACF,MAAM,SAAS,aAAa,OAAO,CAAC,yBAAyB;YAE7D,+DAA+D;YAC/D,MAAM,mBAAmB,IAAA,mJAAqB,EAAC;YAE/C,iCAAiC;YACjC,MAAM,UAAU,CAAC,MAAM,EAAE,YAAY,CAAC,EAAE,OAAO,CAAC,EAAE,KAAK,GAAG,IAAI;YAC9D,MAAM,cAAc,IAAA,uKAAS,IAC1B,SAAS,CAAC,GAAG,IACb,eAAe,CAAC,SAChB,OAAO;YAEV,mBAAmB;YACnB,MAAM,cAAc;gBAClB,YAAY,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK,QAAQ;gBAC5C,UAAU;oBACR;wBACE,SAAS;wBACT,QAAQ,IAAA,oKAAM,EAAC,OAAO,QAAQ;wBAC9B,SAAS,YAAY,KAAK,GAAG,QAAQ,CAAC;oBACxC;iBACD;YACH;YAEA,MAAM,SAAS,MAAM,aAAa,eAAe,CAAC;YAElD,IAAI,QAAQ;gBACV,QAAQ,GAAG,CAAC,qBAAqB;gBAEjC,uCAAuC;gBACvC,IAAI;oBACF,MAAM,kBAAkB,MAAM,MAAM,yBAAyB;wBAC3D,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM,KAAK,SAAS,CAAC;4BACnB,QAAQ,OAAO,GAAG;4BAClB;4BACA;4BACA,QAAQ;4BACR,aAAa;4BACb,WAAW;wBACb;oBACF;oBAEA,MAAM,cAAc,MAAM,gBAAgB,IAAI;oBAE9C,IAAI,YAAY,OAAO,EAAE;wBACvB,MAAM,CAAC,MAAM,EAAE,YAAY,wBAAwB,CAAC;wBACpD,OAAO,QAAQ,CAAC,MAAM;oBACxB,OAAO;wBACL,MAAM,CAAC,wCAAwC,EAAE,YAAY,KAAK,EAAE;oBACtE;gBACF,EAAE,OAAO,cAAc;oBACrB,QAAQ,KAAK,CAAC,6BAA6B;oBAC3C,MAAM;oBACN,OAAO,QAAQ,CAAC,MAAM;gBACxB;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mBAAmB;YACjC,MAAM;QACR,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAI,UAAU;QACZ,qBACE,0PAAC;YACC,QAAQ;YACR,WAAU;sBACX;;;;;;IAIL;IAEA,IAAI,CAAC,SAAS;QACZ,qBACE,0PAAC;YACC,QAAQ;YACR,WAAU;sBACX;;;;;;IAIL;IAEA,qBACE,0PAAC;QACC,SAAS;QACT,UAAU,WAAW;QACrB,WAAU;kBAET,UAAU,kBAAkB,CAAC,QAAQ,EAAE,MAAM,IAAI,CAAC;;;;;;AAGzD"}},
    {"offset": {"line": 1622, "column": 0}, "map": {"version":3,"sources":["file:///Users/stanislavozarchuk/Projects/matrix-ton/frontend/components/TablesContent.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { CanvasTableCard } from '@/components/tables/CanvasTableCard';\nimport { ScrollButtons } from '@/components/ScrollButtons';\nimport { TABLE_PRICES } from '@/lib/types';\nimport { WalletConnectButton } from '@/components/ton/WalletConnectButton';\nimport { TablePurchaseButton } from '@/components/ton/TablePurchaseButton';\n\nexport function TablesContent() {\n  const [userTables, setUserTables] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [userId, setUserId] = useState<string>('1');\n\n  useEffect(() => {\n    const id = typeof window !== 'undefined' \n      ? localStorage.getItem('matrix_ton_user_id') || '1'\n      : '1';\n    setUserId(id);\n    \n    const fetchTables = async () => {\n      try {\n        const response = await fetch(`/api/user/tables?userId=${id}`);\n        const data = await response.json();\n        \n        if (data.success) {\n          setUserTables(data.tables);\n        }\n      } catch (error) {\n        console.error('Failed to fetch tables:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchTables();\n  }, []);\n\n  return (\n    <div className=\"min-h-screen relative\">\n      {process.env.NODE_ENV === 'development' && (\n        <button\n          onClick={() => {\n            localStorage.clear();\n            window.location.href = '/dashboard';\n          }}\n          className=\"fixed top-4 left-4 z-[99999] px-4 py-2 bg-red-500 text-white rounded text-sm\"\n        >\n          Reset Registration\n        </button>\n      )}\n      <ScrollButtons />\n      \n      <div className=\"container mx-auto p-4 md:p-8 min-h-screen relative z-10\">\n        {/* Wallet Connection */}\n        <div className=\"mb-12 flex justify-center\">\n          <WalletConnectButton />\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 max-w-7xl mx-auto mb-12\">\n          {loading ? (\n            <div className=\"col-span-1 md:col-span-2 text-center py-12\" style={{ color: '#ffffff', fontSize: '2rem', fontWeight: 'bold' }}>\n              Loading tables...\n            </div>\n          ) : (\n            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].map((tableNumber) => {\n              const table = userTables.find(t => t.tableNumber === tableNumber);\n              const isActive = table ? table.status === 'ACTIVE' : false;\n              const price = TABLE_PRICES[tableNumber as keyof typeof TABLE_PRICES] || 0;\n              const slots: [(any | null)?, (any | null)?, (any | null)?, (any | null)?] = table ? [\n                table.positions.find((p: any) => p.position === 1) || null,\n                table.positions.find((p: any) => p.position === 2) || null,\n                table.positions.find((p: any) => p.position === 3) || null,\n                table.positions.find((p: any) => p.position === 4) || null\n              ] : [null, null, null, null];\n\n              return (\n                <div key={tableNumber} className=\"w-full\">\n                  <CanvasTableCard\n                    tableNumber={tableNumber}\n                    price={price}\n                    cycles={table?.cycleNumber || 0}\n                    slots={slots}\n                    isActive={isActive}\n                  />\n                  {/* Purchase Button */}\n                  <div className=\"mt-6\">\n                    <TablePurchaseButton \n                      tableNumber={tableNumber}\n                      price={price}\n                      isActive={isActive}\n                    />\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AASO,SAAS;IACd,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6NAAQ,EAAQ,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6NAAQ,EAAS;IAE7C,IAAA,8NAAS,EAAC;QACR,MAAM,KAAK,sCACP,0BACA;QACJ,UAAU;QAEV,MAAM,cAAc;YAClB,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,CAAC,wBAAwB,EAAE,IAAI;gBAC5D,MAAM,OAAO,MAAM,SAAS,IAAI;gBAEhC,IAAI,KAAK,OAAO,EAAE;oBAChB,cAAc,KAAK,MAAM;gBAC3B;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2BAA2B;YAC3C,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG,EAAE;IAEL,qBACE,0PAAC;QAAI,WAAU;;YACZ,oDAAyB,+BACxB,0PAAC;gBACC,SAAS;oBACP,aAAa,KAAK;oBAClB,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB;gBACA,WAAU;0BACX;;;;;;0BAIH,0PAAC,yJAAa;;;;;0BAEd,0PAAC;gBAAI,WAAU;;kCAEb,0PAAC;wBAAI,WAAU;kCACb,cAAA,0PAAC,4KAAmB;;;;;;;;;;kCAGtB,0PAAC;wBAAI,WAAU;kCACZ,wBACC,0PAAC;4BAAI,WAAU;4BAA6C,OAAO;gCAAE,OAAO;gCAAW,UAAU;gCAAQ,YAAY;4BAAO;sCAAG;;;;;mCAI/H;4BAAC;4BAAG;4BAAG;4BAAG;4BAAG;4BAAG;4BAAG;4BAAG;4BAAG;4BAAG;4BAAI;4BAAI;yBAAG,CAAC,GAAG,CAAC,CAAC;4BAC3C,MAAM,QAAQ,WAAW,IAAI,CAAC,CAAA,IAAK,EAAE,WAAW,KAAK;4BACrD,MAAM,WAAW,QAAQ,MAAM,MAAM,KAAK,WAAW;4BACrD,MAAM,QAAQ,wIAAY,CAAC,YAAyC,IAAI;4BACxE,MAAM,QAAsE,QAAQ;gCAClF,MAAM,SAAS,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,QAAQ,KAAK,MAAM;gCACtD,MAAM,SAAS,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,QAAQ,KAAK,MAAM;gCACtD,MAAM,SAAS,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,QAAQ,KAAK,MAAM;gCACtD,MAAM,SAAS,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,QAAQ,KAAK,MAAM;6BACvD,GAAG;gCAAC;gCAAM;gCAAM;gCAAM;6BAAK;4BAE5B,qBACE,0PAAC;gCAAsB,WAAU;;kDAC/B,0PAAC,uKAAe;wCACd,aAAa;wCACb,OAAO;wCACP,QAAQ,OAAO,eAAe;wCAC9B,OAAO;wCACP,UAAU;;;;;;kDAGZ,0PAAC;wCAAI,WAAU;kDACb,cAAA,0PAAC,4KAAmB;4CAClB,aAAa;4CACb,OAAO;4CACP,UAAU;;;;;;;;;;;;+BAbN;;;;;wBAkBd;;;;;;;;;;;;;;;;;;AAMZ"}}]
}